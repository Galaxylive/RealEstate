{% extends "core/base.html" %}
{% load bootstrap3 %}
{% bootstrap_javascript jquery=2 %}
{% load staticfiles %}

{% block style %}
<script src="{% static "slide.js" %}"></script>
<link rel="stylesheet" type="text/css" href="{% static "slide.css" %}">
<style>
.slider-selection {
	background: #BABABA;
}
.vcenter {
	display: inline-block;
	vertical-align: middle;
	float: none;
	margin-left:-3px;
}
.alert-success {
	margin-top: 30px;
}
ul {
	margin-top:50px;
}
.inner-rating {
	padding:20px 0;
}
</style>
{% endblock %}

{% block body %}
	<h2><strong> Evaluation for {{house}}</strong> </h2>
	<h4><em>{{house.address}}</em></h4>
	<ul class="list-group">
		{% for category, score in grades %}
			<li class="list-group-item">
				<div class="row">
					<div class="col-sm-6 vcenter">
						<h4>{{category.summary}}</h4>
						<p>
							{% if category.description %}
								{{ category.description }}
							{% endif %}
						</p>
					</div>
					<div class="col-sm-6 vcenter rating">
						<div class="inner-rating" >
							<center>
								<span class="help-text" style="padding-right: 15px">Bad </span>
									<input id={{category.summary}} class='slide' data-slider-id='slide' type="text" data-slider-min="1" data-slider-max="5" data-slider-step="1" data-slider-value="{% if not score %}3{% else %}{{ score }}{% endif %}"/>
								<span class="help-text" style="padding-left: 15px">Good</span>
							</center>
						</div>
					</div>
				</div>
			</li>
		{% endfor %}
	</ul>
	<form style="margin-bottom:20px" action="{% url 'eval' %}" role="form" method="post">
		{% bootstrap_form form%}
		{% csrf_token %}
		<div style="margin-top: 40px">
			<center>
				{% buttons submit='Save Evaluation' %}{% endbuttons %}
				{% if success %}
					{% bootstrap_alert "Your evaluation is saved!" alert_type='success' %}
				{% endif %}
			</center>
		</div>
	</form>
{% endblock %}

{% block scripts %}
<script>
	$(".slide").slider({
		formatter: function(value) {
			switch(value){
				case 1: return "Very Bad";
				case 2: return "Bad";
				case 3: return "Average";
				case 4: return "Good";
				default: return "Very Good";
			}
		}
	});
	$(".slide").on("change", function(slideEvt) {
		var category = $(this).attr("id");
		$("#id_"+category).val( slideEvt.value.newValue );
	});
	$(window).on("resize", function () {
		var divWidth = $(".row").width();
		if(divWidth < 400){
			$(".rating").css("width", "90%");
			$(".help-text").hide();
		}
		else if(divWidth < 730){
			$(".help-text").show();
			$(".rating").css("width", "90%");
		}
		else{
			$(".help-text").show();
			$(".rating").css("width", "45%").css("margin", "0 auto");
		}
	}).resize();
</script>
{% endblock %}
