{% extends "core/base.html" %}
{% load bootstrap3 %}
{% load staticfiles %}

{% block style %}
<link rel="stylesheet" type="text/css" href="{% static "slide.css" %}">
<style>
.slider-selection {
	background: #BABABA;
}
.vcenter {
	display: inline-block;
	vertical-align: middle;
	float: none;
	margin-left:-3px;
}
.alert-success {
	margin-top: 30px;
}
ul {
	margin-top:50px;
}
.inner-rating {
	padding:20px 0;
}
</style>
{% endblock %}

{% block body %}
	<h2><strong> Evaluation for {{house}}</strong> </h2>
	<h4><em>{{house.address}}</em></h4>
	<ul class="list-group">
		{% for category, score in grades %}
			<li class="list-group-item">
				<div class="row">
					<div class="col-sm-6 vcenter">
						<h4>{{category.summary}}</h4>
						{% if category.description %}
							<p>
								{{ category.description }}
							</p>
						{% endif %}
					</div>
					<div class="col-sm-6 vcenter rating">
						<div class="inner-rating" >
							<center>
                                <span class="help-text" style="padding-right: 15px">{{min_choice}}</span>
                                <input id="category_{{category.id}}" class='slide' data-slider-id='slide' type="text" data-slider-min={{min_score}} data-slider-max={{max_score}} data-slider-step="1" data-slider-value="{% if not score %}{{default_score}}{% else %}{{ score }}{% endif %}"/>
                                <span class="help-text" style="padding-left: 15px">{{max_choice}}</span>
							</center>
						</div>
					</div>
				</div>
			</li>
		{% endfor %}
	</ul>
	<form style="margin-bottom:20px" action="" role="form" method="post">
		{% bootstrap_form form%}
		{% csrf_token %}
		<div style="margin-top: 40px">
			<center>
				{% buttons submit='Save Evaluation' %}{% endbuttons %}
				{% bootstrap_messages %}

			</center>
		</div>
	</form>
{% endblock %}

{% block scripts %}
<script src="{% static "slide.js" %}"></script>
<script>
    var jsScores = {{js_scores|safe}};
	$(".slide").slider({
		formatter: function(value) {
            return jsScores[value] || "";
		}
	});
	$(".slide").on("change", function(slideEvt) {
		var categoryID = $(this).attr("id").toString().replace(/category_/i, "");
		console.log(categoryID);
		$("#id_"+categoryID).val( slideEvt.value.newValue );
	});
	$(window).on("resize", function () {
		var divWidth = $(".row").width();
		if(divWidth < 400){
			$(".rating").css("width", "90%");
			$(".help-text").hide();
		}
		else if(divWidth < 730){
			$(".help-text").show();
			$(".rating").css("width", "90%");
		}
		else{
			$(".help-text").show();
			$(".rating").css("width", "45%").css("margin", "0 auto");
		}
	}).resize();
</script>
{% endblock %}
