{% extends "core/base.html" %}
{% load bootstrap3 %}
{% load staticfiles %}

{% block style %}
<link rel="stylesheet" type="text/css" href="{% static "slide.css" %}">
<style>
ul.list-group {
	padding-top:30px;
}
#heading {
	padding-bottom: 30px;
}
.alert-success {
	margin-top: 30px;
}
.icon-ok {
	display: none;
	font-size: 80%;
	color: green;
	padding-left: 20px
}
.inner-rating {
	padding:20px 0;
}
.slider-selection {
	background: #BABABA;
}
.vcenter {
	display: inline-block;
	vertical-align: middle;
	float: none;
	margin-left:-3px;
}
</style>
{% endblock %}

{% block body %}
{% csrf_token %}
<div id="heading">
	<h2><strong> Evaluation for {{house}}</strong> </h2>
	<h4><em>{{house.address}}</em></h4>
</div>
<p id="save-status" class="pull-right"></p>
<ul class="list-group">
	{% for category, score in grades %}
		<li class="list-group-item">
			<div class="row">
				<div class="col-sm-6 vcenter">
					<h4>{{category.summary}}
						<span id='update_{{category.id}}' class='glyphicon glyphicon-ok icon-ok'></span>
					</h4>
					{% if category.description %}
						<p>
							{{ category.description }}
						</p>
					{% endif %}
				</div>
				<div class="col-sm-6 vcenter rating">
					<div class="inner-rating" style="padding-left:10%" >
						<center>
							<span class="help-text" style="text-size:60%; padding-right: 15px">{{min_choice}}</span>
							<input id="category_{{category.id}}" class='slide' data-slider-id='slide' type="text" data-slider-min={{min_score}} data-slider-max={{max_score}} data-slider-step="1" data-slider-value="{% if not score %}{{default_score}}{% else %}{{ score }}{% endif %}"/>
							<span class="help-text" style="text-size:60%; padding-left: 15px">{{max_choice}}</span>
						</center>
					</div>
				</div>
			</div>
		</li>
	{% endfor %}
</ul>
{% endblock %}

{% block scripts %}
<script src="{% static "slide.js" %}"></script>
<script src="{% static "debounce.js" %}"></script>
<script src="{% static "base.js" %}"></script>

<script>
var jsScores = {{js_scores|safe}}
$(".slide").slider({
	formatter: function(value) {
          return jsScores[value] || "";
	}
});

$(".slide").change($.debounce( 700, slideChange));


$(window).on("resize", function () {
	var divWidth = $(".row").width();
	if(divWidth < 400){
		$(".rating").css("width", "90%");
		$(".help-text").hide();
	}
	else if(divWidth < 730){
		$(".help-text").show();
		$(".rating").css("width", "90%");
	}
	else{
		$(".help-text").show();
		$(".rating").css("width", "45%").css("margin", "0 auto");
	}
}).resize();
</script>
{% endblock %}
